!function(t){var a,e,o,r,n=window.location.origin,i={},s={},l={},c={},d={},h={},m={DS:"#eebb55",ICE:"#4488dd",MTW:"#88ee88",SS:"#eebb55",TC:"#dd66ee",TS:"#ff2200",TSGR:"#ff2200",TURB:"#ee8844",VA:"#bbbbbb"},p={"+":"heavy","-":"light",RE:"recent",VC:"in the vicinity",BC:"patches of",DR:"low drifting",MI:"shallow",PR:"partial",BL:"blowing",FZ:"freezing",SH:"showers",TS:"thunderstorms",BR:"mist",DS:"dust storm",DU:"widespread dust",DZ:"drizzle",FC:"funnel cloud",FG:"fog",FU:"smoke",GR:"hail",GS:"small hail",HZ:"haze",IC:"ice crystals",PE:"ice pellets",PO:"sand whirls",PY:"spray",RA:"rain",SA:"sand",SG:"snow grains",SN:"snow",SQ:"squalls",SS:"sand storm",UP:"unknown",VA:"volcanic ash"},u={thunderstorm:"thunderstorm","heavy storm":"cyclone",squalls:"cyclone",sand:"storm",storm:"storm",ice:"ac_unit",ash:"lens_blur",fog:"foggy",smoke:"foggy",dust:"foggy",haze:"foggy",snow:"weather_snowy",hail:"grain",grain:"grain",drizzle:"rainy",spray:"rainy",rain:"rainy",overcast:"cloud",broken:"partly_cloudy_day",few:"partly_cloudy_day",cloud:"cloud",clear:"sunny"},f={SKC:"clear",CLR:"clear",CAVOK:"cavok",FEW:"few clouds",SCT:"scattered clouds",BKN:"broken clouds",OVC:"overcast",OVX:"overcast"},g={};Math.toRad=t=>t*Math.PI/180,Math.toDeg=t=>180*t/Math.PI;var v=()=>self.crypto.randomUUID(),b=t=>{t.preventDefault(),t.stopPropagation(),t.stopImmediatePropagation()},y=function(a,i={}){i.token=v(),i.path=e,i.referrer=document.referrer,t.ajax({url:n+"/inc/api/"+a+".php",type:"post",data:i,success:function(a){"redirect_to"in(r=JSON.parse(a))?location.href=n+"/"+r.redirect_to:(o=r.page,document.title=x(r.title),t("#content").attr("page",o).html(r.content),"searchtext"in r&&(t('[data-form="search"] input').val(r.searchtext),document.title+=": "+r.searchtext),O(),k())}})},k=function(){t("[data-map]").each((function(){let a=v(),e=JSON.parse(window.atob(t(this).attr("data-map"))),o=e.lat||i.lat||0,r=e.lon||i.lon||0;t(this).attr("id",a).removeAttr("data-map"),l[a]=e,s[a]=L.map(a,{center:[o,r],zoom:e.zoom||12,maxBounds:L.latLngBounds(L.latLng(-90,-180),L.latLng(90,180)),maxBoundsViscosity:1,preferCanvas:!0,scrollWheelZoom:e.wheelZoom||!1}),h[a]=L.layerGroup().addTo(s[a]),d[a]=L.layerGroup().addTo(s[a]),c[a]=L.layerGroup().addTo(s[a]),L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png",{minZoom:e.minZoom||4,maxZoom:e.maxZoom||15,attribution:x("Data by")+' <a href="https://openstreetmap.org">OSM</a> | '+x("© %YEAR%")+' <a href="'+n+'">airportmap.de</a>'}).addTo(s[a]),L.control.scale().addTo(s[a]),e.my&&w(a),s[a].on("moveend",(function(){M(a,s[a])})),M(a,s[a])}))},w=function(t){"lat"in i&&"lon"in i&&L.marker(L.latLng(parseFloat(i.lat),parseFloat(i.lon)),{icon:L.divIcon({iconSize:"100px",iconAnchor:[10,10],className:"mypos",html:'<navicon class="invert"></navicon>'})}).addTo(s[t])},M=function(a,e){let o=e.getBounds(),r=l[a].divider||1;t.ajax({url:n+"/inc/api/_marker.php",type:"post",data:{token:v(),limit:Math.floor(g.max_marker/r),zoom:e.getZoom(),config:l[a],bounds:{lat:[o.getNorth(),o.getSouth()],lon:[o.getEast(),o.getWest()]}},success:function(t){let o=JSON.parse(t),n=Math.floor(g.max_label/r);h[a].clearLayers(),d[a].clearLayers(),c[a].clearLayers(),Object.values(o.sigmets).forEach((function(t){JSON.parse(t.polygon).forEach((function(e){"object"==typeof e&&e.length>1&&e.length==e.filter((t=>"object"==typeof t)).length&&h[a].addLayer(L.polygon(e.filter((t=>t.reverse())),{color:m[t.hazard]||"#eeeeee",weight:1,fillOpacity:.3,dashArray:"4 4"}))}))})),Object.values(o.navaids).forEach((function(t){d[a].addLayer(L.marker(L.latLng(parseFloat(t.lat),parseFloat(t.lon)),{icon:L.divIcon({iconSize:"100px",iconAnchor:[10,10],className:"navaid-"+t.type,html:'<navicon class="invert"></navicon><div class="info">'+_(t.frequency)+"</div>"})}).on("click",(function(t){S(t,a,e)})))})),Object.values(o.airports).forEach((function(t){c[a].addLayer(L.marker(L.latLng(parseFloat(t.lat),parseFloat(t.lon)),{icon:L.divIcon({iconSize:"100px",iconAnchor:[10,10],className:"type-"+t.type+" restrict-"+t.restriction+(--n<0?" no-label":""),html:'<navicon class="invert"></navicon><div class="info">'+t.ICAO+"</div>"})}).on("click",(function(t){A(t,a,e)})))}))}})},A=function(t,a,e){e.setView(t.target.getLatLng(),Math.max(e.getZoom(),8))},S=function(t,a,e){e.setView(t.target.getLatLng(),Math.max(e.getZoom(),8))},x=(t="")=>t.toString().replaceAll("%YEAR%",(new Date).getFullYear()),C=(t,e={})=>new Intl.NumberFormat(a,e).format(t),_=t=>(t=parseInt(t))>1e3?C(t/1e3,{minimumFractionDigits:1})+"&#8239;MHz":C(t)+"&#8239;kHz",N=(t,a="lat")=>{let e=parseFloat(t),o=Math.abs(e),r=Math.floor(o),n=60*(o-r),i=Math.floor(n);return r+"°&#8239;"+i+"′&#8239;"+Math.floor(60*(n-i))+"″&#8239;"+{lat:e<0?"S":"N",lon:e<0?"W":"E"}[a]},E=(t=0)=>x(["N","NNE","NE","ENE","E","ESE","SE","SSE","S","SSW","SW","WSW","W","WNW","NW","NNW","N"][Math.round(t/22.5)]),R=(t,a="sunny")=>{for(const[a,e]of Object.entries(u))if(-1!=t.indexOf(a))return e;return a},j=(t,a=9999,e="CLR")=>{let o=[];if(0==t.trim().length){let t=(r=e)in f?f[r]:"clear";return{text:t,icon:R(t)}}var r;return t.trim().split(" ").forEach((t=>{let a=t.match(/^(\+|-|VC|RE)?([A-Z]{2})([A-Z]{2})?$/).slice(1).map((t=>t in p?p[t]:null)).filter((t=>t));o.push(a.join(" ").trim())})),(o.includes("thunderstorms")||o.includes("showers"))&&(o.length=2),o=o.join(", "),{text:o,icon:R(o)}},O=function(){t("[data-i18n]").each((function(){t(this).html(x(t(this).attr("data-i18n"))).removeAttr("data-i18n")})),t("[data-title]").each((function(){t(this).attr("title",x(t(this).attr("data-title"))).removeAttr("data-title")})),t("[data-placeholder]").each((function(){t(this).attr("placeholder",x(t(this).attr("data-placeholder"))).removeAttr("data-placeholder")})),t("[data-number]").each((function(){t(this).html(C(t(this).attr("data-number"))).removeAttr("data-number")})),t("[data-date]").each((function(){t(this).html(((t,e={})=>{let o=new Date;return o.setTime(Date.parse(t)),o.toLocaleDateString(a,e)})(t(this).attr("data-date"))).removeAttr("data-date")})),t("[data-lat]").each((function(){t(this).html(N(t(this).attr("data-lat"),"lat")).removeAttr("data-lat")})),t("[data-lon]").each((function(){t(this).html(N(t(this).attr("data-lon"),"lon")).removeAttr("data-lon")})),t("[data-alt]").each((function(){t(this).html(C(t(this).attr("data-alt"))+"&#8239;"+x("ft")).removeAttr("data-alt")})),t("[data-msl]").each((function(){t(this).html(C(Math.ceil(t(this).attr("data-msl")/3.281))+"&#8239;m&nbsp;"+x("MSL")).removeAttr("data-msl")})),t("[data-mi]").each((function(){let a=1.609344*t(this).attr("data-mi");t(this).html(a>10?C(10)+"+&#8239;km":a>1?C(Math.floor(a))+"&#8239;km":C(100*Math.floor(10*a))+"&#8239;m").removeAttr("data-mi")})),t("[data-temp]").each((function(){t(this).html(C(t(this).attr("data-temp"))+"&#8239;°C").removeAttr("data-temp")})),t("[data-kt]").each((function(){t(this).html(C(t(this).attr("data-kt"))+"&#8239;kt").removeAttr("data-kt")})),t("[data-altim-hpa]").each((function(){t(this).html(C(Math.round(t(this).attr("data-altim-hpa")))+"&#8239;hPa").removeAttr("data-altim-hpa")})),t("[data-hdg]").each((function(){let a=parseInt(t(this).attr("data-hdg"));isNaN(a)?t(this).empty():(t(this).removeAttr("data-hdg"),t(this).find(".bug").css("transform","rotate( "+a+"deg )"),t(this).find(".deg").html(a+"°"),t(this).find(".cardinal").html(E(a)))})),t("[data-wx]").each((function(){let a=j(t(this).attr("data-wx"),t(this).attr("data-vert")||9999,t(this).attr("data-cover")||"CLR");t(this).removeAttr("data-wx"),t(this).find(".icon").html(a.icon),t(this).find(".label").html(a.text)})),t("[data-freq]").each((function(){t(this).html(_(t(this).attr("data-freq"))).removeAttr("data-freq")})),t("[data-nearby]").each((function(){let a=JSON.parse(window.atob(t(this).attr("data-nearby"))),e=((t,a,e,o)=>{t=Math.toRad(parseFloat(t)),a=Math.toRad(parseFloat(a)),e=Math.toRad(parseFloat(e));let r=(o=Math.toRad(parseFloat(o)))-a,n=Math.cos(e)*Math.sin(r),i=Math.cos(t)*Math.sin(e)-Math.sin(t)*Math.cos(e)*Math.cos(r),s=(Math.toDeg(Math.atan2(n,i))+360)%360;return{heading:s,label:E(s)}})(a.p1.lat,a.p1.lon,a.p2.lat,a.p2.lon);t(this).find(".heading .bug").css("transform","rotate( "+e.heading+"deg )"),t(this).find(".heading .deg").html(Math.round(e.heading)+"°"),t(this).find(".meta .label").html(e.label),t(this).find(".meta .dist").html(Math.ceil(a.dist)+"&#8239;nm"),t(this).removeAttr("data-nearby")})),t("[data-bc]").each((function(){t(this).html(((a,e=0)=>{let o=['<a href="'+n+'/world">'+x("World")+"</a>"];return a.split("::").forEach((function(a){if((label=a.substring(1)).length>0){let r=a.charAt(0);o.push('<a href="'+n+"/"+{T:"continent",C:"country",R:"region",M:"municipality"}[r]+"/"+label.replaceAll(" ","_")+'">'+x(e&&"M"!=r?t.ajax({url:n+"/inc/api/_bc.php",type:"post",data:{token:v(),type:r,ident:label},async:!1}).responseText:label)+"</a>")}})),o.join('<span class="divider">/</span>')})(t(this).attr("data-bc"),t(this).attr("data-bcdb")||0)).removeAttr("data-bc data-bcdb")})),t("[data-morse]").each((function(){t(this).html(((t="",a=!1)=>{let e={a:".-",b:"-...",c:"-.-.",d:"-..",e:".",f:"..-.",g:"--.",h:"....",i:"..",j:".---",k:"-.-",l:".-..",m:"--",n:"-.",o:"---",p:".--.",q:"--.-",r:".-.",s:"...",t:"-",u:"..-",v:"...-",w:".--",x:"-..-",y:"-.--",z:"--..",1:".----",2:"..---",3:"...--",4:"....-",5:".....",6:"-....",7:"--...",8:"---..",9:"----.",0:"-----"};return a?t.split(" ").map((t=>Object.keys(e).find((a=>e[a]===t)).toUpperCase())).join(""):t.split("").map((t=>e[t.toLowerCase()])).join(" ").replaceAll(".","·")})(t(this).attr("data-morse"),!!t(this).attr("data-decode"))).removeAttr("data-morse data-decode")})),t("[data-pagination]").each((function(){let a=JSON.parse(window.atob(t(this).attr("data-pagination")));t(this).html(((t=0,a=1)=>{if(t<=6)return"";let o=Math.ceil(t/24),r=n+"/"+e.slice(0,2).join("/")+"/",i=[],s=0;return[1,Math.max(1,a-2),Math.max(1,a-1),a,Math.min(o,a+1),Math.min(o,a+2),o].filter(((t,a,e)=>e.indexOf(t)===a)).forEach((t=>{t>s+1&&i.push('<span class="dots"><span>…</span></span>'),i.push(t==a?'<span class="curr"><span>'+C(t)+"</span></span>":'<a class="link" href="'+r+t+'"><span>'+C(t)+"</span></a>"),s=t})),i.length<=1&&(i=[]),'<div class="pagelinks">'+i.join("")+'</div><div class="results"><b>'+C(t)+"</b>&nbsp;"+x("Results")+"</div>"})(a.results,a.page)).removeAttr("data-pagination")})),t("[data-href]").each((function(){t(this).attr("href",n+"/"+t(this).attr("data-href").replaceAll(" ","_")).removeAttr("data-href")})),t("[data-nav]").removeClass("active"),t('[data-nav="'+o+'"]').addClass("active"),t("[data-tab]").removeClass("active"),t('[data-tab="'+(r.tab||"_")+'"]').addClass("active"),t("[data-subtab]").removeClass("active"),t('[data-subtab="'+(r.subtab||"_")+'"]').addClass("active"),t('[data-action="select-language"]').each((function(){t(this).val(a)}))};t(document).on("submit","[data-form]",(function(a){switch(b(a),t(this).attr("data-form")){case"search":location.href=n+"/search/"+t(this).find('[name="searchtext"]').val().trim().replaceAll(" ","_");break}return!1})),t(document).on("click","[data-action]",(function(a){switch(b(a),t(this).attr("data-action")){case"scroll-to-top":t("html, body").animate({scrollTop:0},"fast");break}})),t(document).on("change","[data-action]",(function(a){switch(b(a),t(this).attr("data-action")){case"select-language":t.cookie("locale",t(this).val()),location.reload();break}})),t(document).ready((function(){t.cookie.defaults={path:"/",expires:365},navigator.geolocation.getCurrentPosition((function(t){i={lat:t.coords.latitude,lon:t.coords.longitude}})),"serviceWorker"in navigator&&navigator.serviceWorker.register(n+"/service-worker.min.js",{scope:"/"}),(()=>{if(navigator.userAgentData.mobile)g.max_marker=50,g.max_label=25;else{let t=navigator.hardwareConcurrency||4,a=navigator.deviceMemory||2;t<2||a<1?(g.max_marker=100,g.max_label=50):t<4||a<2?(g.max_marker=150,g.max_label=75):(g.max_marker=250,g.max_label=100)}})(),a=t.cookie("locale")||"en-US",t("html").attr("lang",a),function(){switch(((e=window.location.pathname.split("/").filter((t=>t)))[0]||"").toString().trim().toLowerCase()){case"airport":y("airport",{airport:e[1]||"",tab:e[2]||"info",subtab:e[3]||""});break;case"search":y("search",{searchtext:(e[1]||"").replaceAll("_"," "),page:parseInt(e[2]||1)});break;case"airports":case"world":y("airports");break;case"continent":y("airports",{type:"continent",code:e[1]||""});break;case"country":y("airports",{type:"country",code:e[1]||""});break;case"region":y("airports",{type:"region",code:e[1]||"",page:parseInt(e[2]||1)});break;default:y("map");break}}()})),t(document).scroll((function(){t(window).scrollTop()>200?t("body").addClass("scroll-to-top"):t("body").removeClass("scroll-to-top")}))}(jQuery);